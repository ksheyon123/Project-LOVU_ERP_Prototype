<!DOCTYPE html>
<html>

<head>
    <script src="https://code.jquery.com/jquery-3.4.1.js"
        integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU=" crossorigin="anonymous"></script>
</head>

<body>
    날짜 :
    <select id="start_year" name="start_year">
    </select>
    <select id="start_month" name="start_month">
    </select>
    <select id="start_day" name="start_day">
    </select> ~
    <select id="end_year" name="end_year">
    </select>
    <select id="end_month" name="end_month">
    </select>
    <select id="end_day" name="end_day">
    </select>

    <input type='button' id='periodBtn' value='조회' onclick='getPeriod()'>

    <div>
        <table width='1500px'>
            <tr>
                <td>No.</td>
                <td>제품코드</td>
                <td>제품명</td>
                <td>용량</td>
                <td>재고</td>
                <td>반품</td>
                <td>본사</td>
                <td>기타</td>
                <td>판매</td>
                <td>본사</td>
                <td>기타</td>
                <td>과도</td>
                <td>부족</td>
                <td>실수량</td>
            </tr>
            <tbody id='tblShow'>

            </tbody>
        </table>
    </div>
</body>
<script src='/javascripts/period.js'></script>
<script>

    getPeriod = async () => {
        var startYear = $('#start_year option:selected').val();
        var startMonth = $('#start_month option:selected').val();
        var startDay = $('#start_day option:selected').val();
        var endYear = $('#end_year option:selected').val();
        var endMonth = $('#end_month option:selected').val();
        var endDay = $('#end_day option:selected').val();
        try {
            const response = await fetch('http://localhost:3000/getPeriodData', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ startYear: startYear, startMonth: startMonth, startDay: startDay, endYear: endYear, endMonth: endMonth, endDay: endDay })
            });

            var json = await response.json();
            if (response.ok) {
                var objRow;
                for (var i = 0; i < json.length; i++) {
                    objRow = document.all('tblShow').insertRow();

                    //No.
                    var objCell_Num = objRow.insertCell();
                    objCell_Num.innerHTML = i + 1;

                    //Product Code
                    var objCell_Code = objRow.insertCell();
                    objCell_Code.innerHTML = json[i].itemCode;

                    //Product Name
                    var objCell_Name = objRow.insertCell();
                    objCell_Name.innerHTML = json[i].itemName;

                    //Product Capacity(Volume)
                    var objCell_Cp = objRow.insertCell();
                    objCell_Cp.innerHTML = json[i].itemVolume;

                    //Product Recall Count
                    var objCell_rCnt = objRow.insertCell();
                    objCell_rCnt.innerHTML = json[i].qty.recall;

                    //Product holdings1 Count
                    var objCell_hCnt = objRow.insertCell();
                    objCell_hCnt.innerHTML = json[i].qty.holdings1;

                    //Product etc1 Count
                    var objCell_eCnt = objRow.insertCell();
                    objCell_eCnt.innerHTML = json[i].qty.etc1;

                    //Product sell Count
                    var objCell_rCnt = objRow.insertCell();
                    objCell_rCnt.innerHTML = json[i].qty.sell;

                    //Product holdings2 Count
                    var objCell_hCnt = objRow.insertCell();
                    objCell_hCnt.innerHTML = json[i].qty.holdings2;

                    //Product etc2 Count
                    var objCell_eCnt = objRow.insertCell();
                    objCell_eCnt.innerHTML = json[i].qty.etc2;

                    //Product over Count
                    var objCell_eCnt = objRow.insertCell();
                    objCell_eCnt.innerHTML = json[i].qty.over;

                    //Product lack Count
                    var objCell_eCnt = objRow.insertCell();
                    objCell_eCnt.innerHTML = json[i].qty.lack;

                    //Product Real Count
                    var objCell_eCnt = objRow.insertCell();
                    objCell_eCnt.innerHTML = (json[i].qty.recall + json[i].qty.holdings1 + json[i].qty.etc1) - (json[i].qty.sell + json[i].qty.holdings2 + json[i].qty.etc2) + json[i].qty.over - json[i].qty.lack;
                }
            }
        } catch (err) {
            console.log(err)
        }
    }
</script>

</html>